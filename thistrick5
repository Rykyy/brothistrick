-- Variable
local plr = game:GetService("Players").LocalPlayer
local reps = game:GetService("ReplicatedStorage")
local wrk = game:GetService("Workspace")
local gameName = "Anime Journey"
local classname = plr.Stats:GetAttribute("Class")
local cl1
local cl2
local beat;
local a1beat;
local aunk;
local aunp;
local moblist;
local idk;



-- Global
getgenv().enabled = nil
getgenv().mobname = "SemiHollow"
getgenv().questname = "1"
getgenv().statname = "Power"
getgenv().distance = 0
getgenv().mode = nil

-- Table
local mobTable = {}
local questTable = {"1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","19","20","21"}
local statTable = {"Power", "Stamina", "Defence"}
local classTable = {}
local classTable1 = {}

for _,v in pairs(wrk.NPCS:GetChildren()) do
    insert = true
    for _,v2 in pairs(mobTable) do if v2 == tostring(v.Name) then insert = false end end
    if insert then table.insert(mobTable, tostring(v.Name)) end
end

for _,v in pairs(reps.Assets.Class:GetChildren()) do
    insert = true
    for _,v2 in pairs(classTable) do if v2 == tostring(v.Name) then insert = false end end
    if insert then table.insert(classTable, tostring(v.Name)) end
end

-- Function

local function nameGui()
    local name = nil
    for i,v in pairs(game.CoreGui:GetDescendants()) do
        if v.Name == "UITabs" and v.Parent.Name == "Main" then
            name = v.Parent.Parent
        end
    end
    return name
end


local function pesan(title, text, time)
    local NotificationHolder = loadstring(game:HttpGet("https://raw.githubusercontent.com/BocusLuke/UI/main/STX/Module.Lua"))()
    local Notification = loadstring(game:HttpGet("https://raw.githubusercontent.com/BocusLuke/UI/main/STX/Client.Lua"))()

    Notification:Notify(
        {Title = title, Description = text},
        {OutlineColor = Color3.fromRGB(255, 84, 84),Time = time, Type = "image"},
        {Image = "http://www.roblox.com/asset/?id=6023426923", ImageColor = Color3.fromRGB(255, 84, 84)}
    )
end


local function tpto(obj)
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = obj

    if not game.Players.LocalPlayer.Character.HumanoidRootPart:FindFirstChild("BodyVelocity") then
        aunk = Instance.new("BodyVelocity", game.Players.LocalPlayer.Character.HumanoidRootPart)
        aunk.Velocity = Vector3.new(0, 0, 0)
        aunk.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    end
end

local function shop()
    local x = {}
    for _, v in ipairs(game:GetService("HttpService"):JSONDecode(game:HttpGetAsync("https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100")).data) do
        if type(v) == "table" and v.maxPlayers > v.playing and v.id ~= game.JobId then
           x[#x + 1] = v.id
        end
    end
    if #x > 0 then
       game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, x[math.random(1, #x)])
       wait(5)
       game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, x[math.random(1, #x)])
	else
        print("....")
	end
end

game:GetService("RunService").Stepped:Connect(function()
    for i,v1 in pairs(reps:GetChildren()) do
        if v1:FindFirstChild("CooldownModule") then
            v1.CooldownModule:Destroy()
        end
    end
end)

game:GetService("RunService").Heartbeat:Connect(function()
    if getgenv().enabled == false then 
        if game.Players.LocalPlayer.Character.HumanoidRootPart:FindFirstChild("BodyVelocity") then
            aunk:Destroy()
        end
    end
end)

wrk.NPCS.ChildAdded:Connect(function()
    for _,v2 in pairs(mobTable) do table.remove(mobTable, _) end
    for _,v2 in pairs(mobTable) do table.remove(mobTable, _) end

    for _,v in pairs(wrk.NPCS:GetChildren()) do
        insert = true 
        for _,v2 in pairs(mobTable) do if v2 == v.Name then insert = false end end
        if insert then table.insert(mobTable, v.Name) end
    end
    moblist:Refresh(mobTable, 1, getgenv().mobname)
end)

wrk.NPCS.ChildRemoved:Connect(function()
    for _,v2 in pairs(mobTable) do table.remove(mobTable, _) end
    for _,v2 in pairs(mobTable) do table.remove(mobTable, _) end

    for _,v in pairs(wrk.NPCS:GetChildren()) do
        insert = true 
        for _,v2 in pairs(mobTable) do if v2 == v.Name then insert = false end end
        if insert then table.insert(mobTable, v.Name) end
    end
    moblist:Refresh(mobTable, 1, getgenv().mobname)
end)

-- Library
local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/Rykyy/brothistrick/main/brorqdassdax"))()

local window = library:CreateTab("AJ")
local misc = library:CreateTab("Misc")

local fq = window:CreateSection("Auto Farm & Auto Quest")
local sb = window:CreateSection("Auto Stats & Auto Buy")
local sc = misc:CreateSection("Server & Character")

pesan(gameName, "This Script Made By Ikky#8337\n".."~"..plr.DisplayName.."~ Thx For Using My Script.", 10)

-- Main Section

fq:CreateLabel("~~Mob Settings")

moblist = fq:CreateDropdown("Mob List", mobTable, 1, "SemiHollow", function(selected)
    getgenv().mobname = selected
end)

fq:CreateSlider("Distance", -15, 15, getgenv().distance, 0.999, function(s)
    getgenv().distance = s

    if getgenv().distance >= 0  then
        getgenv().mode = CFrame.Angles(math.rad(-90),0,0)
    elseif getgenv().distance <= -1 then
        getgenv().mode = CFrame.Angles(math.rad(90),0,0)
    end
end)

fq:CreateToggle("Reset when energy is low\nto restore energy", function(bool)
    getgenv().reset = bool

    rx = game:GetService("RunService").Heartbeat:Connect(function()
        if getgenv().reset == true and plr.Stats:GetAttribute("Energy") <= 3 and getgenv().enabled == true then
            plr.Character:BreakJoints()
        elseif getgenv().reset == false then
            rx:Disconnect()
        end
    end)
end)

fq:CreateLabel("~~Attack Settings")

fq:CreateToggle("Basic Attack", function(bool)
    a1 = bool

    a1beat = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and a1 == true and not plr.Character.LowerTorso:FindFirstChild("Root") then
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Punch",1)
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Punch",2)
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Punch",3)
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Punch",4)
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Punch",5)
        elseif getgenv().enabled == false and a1 == false then
            a1beat:Disconnect()
        end
    end)
end)

fq:CreateToggle("Skill1", function(bool)
    a2 = bool

    a2beat = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and a2 == true and not plr.Character.LowerTorso:FindFirstChild("Root") then
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Skill1",1)
        elseif getgenv().enabled == false and a2 == false then
            a1beat:Disconnect()
        end
    end)
end)

fq:CreateToggle("Skill2", function(bool)
    a3 = bool

    a3beat = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and a3 == true and not plr.Character.LowerTorso:FindFirstChild("Root") then
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Skill2",1)
        elseif getgenv().enabled == false and a3 == false then
            a1beat:Disconnect()
        end
    end)
end)

fq:CreateToggle("Skill3", function(bool)
    a4 = bool

    a4beat = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and a4 == true and not plr.Character.LowerTorso:FindFirstChild("Root") then
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Skill3",1)
        elseif getgenv().enabled == false and a4 == false then
            a1beat:Disconnect()
        end
    end)
end)

fq:CreateToggle("Skill4", function(bool)
    a5 = bool

    a5beat = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and a5 == true and not plr.Character.LowerTorso:FindFirstChild("Root") then
            reps.Remotes.SKILL_EVENT:FireServer(classname.."|Skill4",1)
        elseif getgenv().enabled == false and a5 == false then
            a1beat:Disconnect()
        end
    end)
end)

fq:CreateLabel("~~Farm")

fq:CreateToggle("Enabled", function(bool)
    getgenv().enabled = bool

    xx = game:GetService("RunService").Heartbeat:Connect(function()
        if getgenv().enabled == true then
            if plr.Character.LowerTorso:FindFirstChild("Root") then
                plr.Character.HumanoidRootPart.CFrame = CFrame.new(-325.257965, 62.4754448, 2155.13135, 0.999768972, -2.21638849e-08, 0.0214943159, 2.40191138e-08, 1, -8.60543636e-08, -0.0214943159, 8.65507559e-08, 0.999768972)
                wait(0.5)
                plr.Character.LowerTorso.Root:Destroy()
            end
            if a1 == true then
                reps.Remotes.HITBOX_EVENT:FireServer(classname.."|Punch",idk.HumanoidRootPart.Position,idk,true)
            end
            if a2 == true then
                reps.Remotes.HITBOX_EVENT:FireServer(classname.."|Skill1",idk.HumanoidRootPart.Position,idk,true)
            end
            if a3 == true then
                reps.Remotes.HITBOX_EVENT:FireServer(classname.."|Skill2",idk.HumanoidRootPart.Position,idk,true)
            end
            if a4 == true then
                reps.Remotes.HITBOX_EVENT:FireServer(classname.."|Skill3",idk.HumanoidRootPart.Position,idk,true)
            end
            if a5 == true then
                reps.Remotes.HITBOX_EVENT:FireServer(classname.."|Skill4",idk.HumanoidRootPart.Position,idk,true)
            end
        elseif getgenv().enabled == false then
            xx:Disconnect()
        end
    end)

    bruh = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and plr.Character ~= nil then
            pcall(function()
                for i, v in pairs(game.Players.LocalPlayer.Character:GetDescendants()) do
                    if v:IsA("BasePart") and v.CanCollide == true then
                        v.CanCollide = false
                        game.Players.LocalPlayer.Character.HumanoidRootPart.Velocity = Vector3.new(0, 0, 0)
                    end
                end
            end)
        elseif getgenv().enabled == false then
            bruh:Disconnect()
        end
    end)

    
    beat = game:GetService("RunService").Heartbeat:Connect(function()
        pcall(function()
            if getgenv().enabled == true then
                for i,v in pairs(wrk.NPCS:GetChildren()) do
                    if v.Name == getgenv().mobname then
                        if v:FindFirstChild("HumanoidRootPart") and v:FindFirstChild("Humanoid") then
                            if v.Humanoid.Health ~= 0 and getgenv().enabled == true then
                                repeat
                                    idk = v
                                    if not plr.Character.LowerTorso:FindFirstChild("Root") then
                                        tpto(v.HumanoidRootPart.CFrame * CFrame.new(0,getgenv().distance,0) * getgenv().mode)
                                    end
                                    wait()
                                until getgenv().enabled == false or not v:FindFirstChild("HumanoidRootPart") or v.Humanoid.Health == 0
                                if getgenv().enabled == false then
                                    beat:Disconnect()
                                end
                            end
                        end
                    end
                end
            end
        end)
    end)

    if getgenv().enabled == false then
        plr.Character:BreakJoints()
    end
end)

fq:CreateLabel("~~Quest")

fq:CreateDropdown("Quest List", questTable, 1, getgenv().questname, function(selected)
    getgenv().questname = selected
end)

fq:CreateToggle("Enabled", function(bool)
    getgenv().enabled1 = bool

    game:GetService("RunService").Heartbeat:Connect(function()
        if getgenv().enabled1 == true and plr.PlayerGui.Frames.Quest.Visible == false then
            plr.Character.HumanoidRootPart.CFrame = wrk.QUEST[tostring(getgenv().questname)].RightFoot.CFrame
            local args = {
                [1] = "QuestAdd",
                [2] = getgenv().questname   
            }
            
            game:GetService("ReplicatedStorage").Remotes.QUEST_EVENT:FireServer(unpack(args))
        end
    end)     
end)

-- Main2 Section

sb:CreateLabel("~~Stats")

sb:CreateDropdown("Stats List", statTable, 1, statTable[1], function(selected)
    getgenv().statname = selected
end)

sb:CreateToggle("Enabled", function(bool)
    getgenv().enabled2 = bool

    game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled2 == true then
            reps.Remotes.REMOTE_EVENT:FireServer("Add"..getgenv().statname, 1)
        end
    end)
end)

sb:CreateLabel("~~Buy")

cl1 = sb:CreateDropdown("Class List", classTable, 1, classTable[1], function(selected)
    for i,v in pairs(classTable) do
        if v == selected then
            table.remove(classTable, i)
            table.insert(classTable1, 1, v)
            cl1:Refresh(classTable, 1, "Selected!")
            cl2:Refresh(classTable1, 1, "Add "..v)
        end
    end
end)

cl2 = sb:CreateDropdown("SelectedClass", classTable1, 1, "---", function(selected)
    for i,v in pairs(classTable1) do
        if v == selected then
            table.remove(classTable1, i)
            table.insert(classTable, v)
            cl1:Refresh(classTable, 1, classTable[1])
            cl2:Refresh(classTable1, 1, "Remove "..v)
        end
    end
end)

sb:CreateToggle("Enabled\n[Tell Me In Disc If Bugged]", function(bool)
    getgenv().enabled3 = bool

    while wait() do
        if getgenv().enabled3 == true then
            for i,v in pairs(classTable1) do
                print(v)
                if v ~= nil and v ~= classname then
                    reps.Remotes.SPIN_EVENT:FireServer("CLASS")
                elseif v == classname then
                    break;
                end
            end
        end
    end
end)
        

-- Misc Section

sc:CreateLabel("~~Server")


sc:CreateButton("Rejoin", function()
    game:GetService('TeleportService'):TeleportToPlaceInstance(game.PlaceId, game.JobId, plr)
end)

sc:CreateButton( "Server Hop", function()
    shop()
end)

sc:CreateLabel("~~Character")

sc:CreateSlider("Walk Speed", 16, 125, 16, 0, function(s)
    local __ = plr.Character

    if ___ and not _G.___ == true then
        __.Humanoid.WalkSpeed = s
        return
    else
        _ = hookmetamethod(__, "__index", function(self,w)
            if w == "WalkSpeed" then
                return 16
            end
            return _(self,w)
        end)
    end
    
    pcall(function()
        getgenv().___ = true
    end)
end)

sc:CreateLabel("~~Admin Gui")

sc:CreateButton("Infinite Yield", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()  
end)

sc:CreateLabel("~~UI Settings")

sc:CreateKeybind("Toggle Ui", Enum.KeyCode.RightAlt, false, false, function()
    local TweenService = game:GetService("TweenService")

    if getgenv().toggleui then
        getgenv().toggleui = false
        TweenService:Create(nameGui().Main, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(0, 450, 0, 0)}):Play()
        TweenService:Create(nameGui().Main.Border, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {ImageTransparency = 1}):Play()    
    else
        getgenv().toggleui = true
        TweenService:Create(nameGui().Main, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(0, 450, 0, 250)}):Play()
        TweenService:Create(nameGui().Main.Border, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {ImageTransparency = 0}):Play()
    end
end)

sc:CreateButton("Destroy UI", function()
    for i,v in pairs(game.CoreGui:GetDescendants()) do
        if v.Name == "UITabs" and v.Parent.Name == "Main" then
            v.Parent.Parent:Destroy()
        end
    end
end)
