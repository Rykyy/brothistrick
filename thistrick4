-- Variable
local TweenService = game:GetService("TweenService")
local plyr = game.Players.LocalPlayer
local gameName = "⚔️MeloBlox"
local moblist;
local tplist;
local tpbeat;
local beat;
local a1beat;
local a2beat;
local a3beat;
local aunk;
local aunp;

-- Global
getgenv().area = "Tutorial"
getgenv().areatp = "SunnyForest"
getgenv().stat = "Strength"
getgenv().mobname = "Blob"
getgenv().ws = 19
getgenv().jp = 50
getgenv().distance = 7.7
getgenv().target = "Random"
getgenv().mode = 300
getgenv().toggleui = true


-- Table
local areaTable = {"Tutorial", "SunnyForest", "DenseForest", "ToadstoolGorge", "BullfrogMarsh", "AridDesert"}
local mobTable = {}
local statsTable = {"Strength", "Dexterity", "Vitality", "Intelligence"}
local areatpTable = {"SunnyForest", "DenseForest", "ToadstoolGorge", "BullfrogMarsh", "AridDesert"}

for _,v in pairs(game:GetService("Workspace").RunTime[getgenv().area]:GetDescendants()) do
    if v.Name == "CreatureName" then
        insert = true
        for _,v2 in pairs(mobTable) do if v2 == tostring(v.Text) then insert = false end end
        if insert then table.insert(mobTable, tostring(v.Text)) end
    end
end

-- Function

local function nameGui()
    local name = nil
    for i,v in pairs(game.CoreGui:GetDescendants()) do
        if v.Name == "UITabs" and v.Parent.Name == "Main" then
            name = v.Parent.Parent
        end
    end
    return name
end


local function noclip()
    for i, v in pairs(game.Players.LocalPlayer.Character:GetDescendants()) do
        if v:IsA("BasePart") and v.CanCollide == true then
            v.CanCollide = false
            game.Players.LocalPlayer.Character.HumanoidRootPart.Velocity = Vector3.new(0, 0, 0)
        end
    end
end

local function backtosafeTp()
    local dist = math.huge
    for i,v in pairs(game.Workspace.RegionsAssets[getgenv().area].PlayerSpawner:GetChildren()) do
        if v.ClassName == "SpawnLocation" then
            local magnitude = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - v.Position).magnitude
            if magnitude < dist then
                dist = magnitude
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.CFrame * CFrame.new(0,3,0)
            end 
        end
    end
end

local function moveto(obj)
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = obj

    if not game.Players.LocalPlayer.Character.HumanoidRootPart:FindFirstChild("BodyVelocity") then
        aunk = Instance.new("BodyVelocity", game.Players.LocalPlayer.Character.HumanoidRootPart)
        aunk.Velocity = Vector3.new(0, 0, 0)
        aunk.MaxForce = Vector3.new(9e9, 9e9, 9e9)
        aunp = game:GetService("RunService").Stepped:Connect(noclip)
    end
end

local function nearestItem()
    local dist = math.huge
    local dekat = nil
    for i,v in pairs(game:GetService("Workspace").RunTime.GroundLoot:GetChildren()) do
        if v.ClassName == "MeshPart" or v.ClassName == "Part" then
            local magnitude = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - v.Position).magnitude
            if magnitude < dist then
                dist = magnitude
                dekat = v.Name
            end
        end
    end
    return dekat
end

local function shop()
    local x = {}
    for _, v in ipairs(game:GetService("HttpService"):JSONDecode(game:HttpGetAsync("https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100")).data) do
        if type(v) == "table" and v.maxPlayers > v.playing and v.id ~= game.JobId then
           x[#x + 1] = v.id
        end
    end
    if #x > 0 then
       game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, x[math.random(1, #x)])
       wait(5)
       game:GetService("TeleportService"):TeleportToPlaceInstance(game.PlaceId, x[math.random(1, #x)])
	else
        print("....")
	end
end

local function pesan(title, text, time)
    local NotificationHolder = loadstring(game:HttpGet("https://raw.githubusercontent.com/BocusLuke/UI/main/STX/Module.Lua"))()
    local Notification = loadstring(game:HttpGet("https://raw.githubusercontent.com/BocusLuke/UI/main/STX/Client.Lua"))()

    Notification:Notify(
        {Title = title, Description = text},
        {OutlineColor = Color3.fromRGB(255, 84, 84),Time = time, Type = "image"},
        {Image = "http://www.roblox.com/asset/?id=6023426923", ImageColor = Color3.fromRGB(255, 84, 84)}
    )
end

local function nearestMob()
    local dist = math.huge
    local dekat = nil
    for i,v in pairs(game:GetService("Workspace").RunTime[getgenv().area].Creatures:GetChildren()) do
        if v:FindFirstChild("HumanoidRootPart") then
            if v.HumanoidRootPart.HealthGUI.HealthBar.CreatureName.Text == getgenv().mobname and getgenv().enabled == true then
                local magnitude = (game.Players.LocalPlayer.Character.HumanoidRootPart.Position - v.HumanoidRootPart.Position).magnitude
                if magnitude < dist then
                    dist = magnitude
                    dekat = v
                end
            end
        end
    end
    return dekat
end


game:GetService("RunService").Heartbeat:Connect(function()
    if game.Players.LocalPlayer.Character.HumanoidRootPart:FindFirstChild("PlayerInfo") then
        game.Players.LocalPlayer.Character.HumanoidRootPart.PlayerInfo:Destroy()
    end
end)

game:GetService("RunService").Heartbeat:Connect(function()
    if getgenv().enabled == false and game.Players.LocalPlayer.Character.HumanoidRootPart:FindFirstChild("BodyVelocity") then
        aunk:Destroy()
        aunp:Disconnect()
    end
end)


repeat wait() until game:IsLoaded() 
    game:GetService("Players").LocalPlayer.Idled:connect(function()
    game:GetService("VirtualUser"):ClickButton2(Vector2.new())
end)


-- Library
local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/Rykyy/roblox/scripts/CoaUix.lua"))()

local window = library:CreateTab(gameName)
local misc = library:CreateTab("Misc")

local autofarm = window:CreateSection("Auto Farm")
local st = window:CreateSection("Auto Stats & Teleports")
local sc = misc:CreateSection("Server & Character")

pesan(gameName, "This Script Made By Rykyy#8337\n".."~"..plyr.DisplayName.."~ Thx For Using My Script.", 10)
pesan("Notification!", "If you want to fix gui bugs please rejoin or server hop", 25)
pesan("Notification!", "Hide Name & Anti Afk Activated\n[Keep Activated Even though you are dead]", 5)

autofarm:CreateLabel("~~Mob Settings")

autofarm:CreateDropdown("Area List", areaTable, 1, function(selected)
    getgenv().area = selected

    for _,v2 in pairs(mobTable) do table.remove(mobTable, _) end 
    for _,v2 in pairs(mobTable) do table.remove(mobTable, _) end

    for _,v in pairs(game:GetService("Workspace").RunTime[selected].Creatures:GetChildren()) do
        if v:FindFirstChild("HumanoidRootPart") then
            insert = true
            for _,v2 in pairs(mobTable) do if v2 == tostring(v.HumanoidRootPart.HealthGUI.HealthBar.CreatureName.Text) then insert = false end end
            if insert then table.insert(mobTable, tostring(v.HumanoidRootPart.HealthGUI.HealthBar.CreatureName.Text)) end
        end 
    end
    moblist:Refresh(mobTable, 1, "AreaHasBeenChanged")
    pesan("Mob Settings Notification!", "Make sure the area you choose is open otherwise you will be banned", 2.5)
end)

moblist = autofarm:CreateDropdown("Mob List", mobTable, 1, function(selected)
    getgenv().mobname = selected
    print(selected)
end)

autofarm:CreateDropdown("Mode List", {"Above", "Under"}, 1, function(selected)
    if selected == "Above" then
        getgenv().mode = 300
    elseif selected == "Under" then
        getgenv().mode = -300
    end
end)

autofarm:CreateDropdown("Target List", {"Random", "Nearest"}, 1, function(selected)
    getgenv().target = selected
end)

autofarm:CreateSlider("Distance", 0, 13, getgenv().distance, 0.999, function(s)
    getgenv().distance = s
end)

autofarm:CreateLabel("~~Attack Action Settings")

autofarm:CreateToggle("Slot 1", function(bool)
    a1 = bool

    a1beat = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and a1 == true then
            local args = {
                [1] = "Action1",
                [2] = "Down"
            }
                                                            
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.InputReceived:FireServer(unpack(args))
        elseif getgenv().enabled == false and a1 == false then
            a1beat:Disconnect()
        end
    end)
end)

autofarm:CreateToggle("Slot 2", function(bool)
    a2 = bool

    a2beat = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and a2 == true then
            local args = {
                [1] = "Action2",
                [2] = "Down"
            }
                                                            
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.InputReceived:FireServer(unpack(args))
        elseif getgenv().enabled == false and a2 == false then
            a2beat:Disconnect()    
        end
    end)
end)


autofarm:CreateToggle("Slot 3", function(bool)
    a3 = bool

    a3beat = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().enabled == true and a3 == true then
            local args = {
                [1] = "Action3",
                [2] = "Down"
            }
                                                            
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.InputReceived:FireServer(unpack(args))
        elseif getgenv().enabled == false and a3 == false then
            a3beat:Disconnect()
        end
    end)
end)


autofarm:CreateButton("Get All Weapon Skill", function()
    for i,v in pairs(game.Players.LocalPlayer.Character:GetChildren()) do
        if string.find(v.Name, "Axe") then
            local args = {
                [1] = "Action1",
                [2] = "BasicAttack"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
            local args = {
                [1] = "Action2",
                [2] = "FireSlash"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
            local args = {
                [1] = "Action3",
                [2] = "GroundSlam"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
        elseif string.find(v.Name, "Sword") and not string.find(v.Name, "Shield")  then
            local args = {
                [1] = "Action1",
                [2] = "BasicAttack"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
            local args = {
                [1] = "Action2",
                [2] = "SwiftStrike"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
            local args = {
                [1] = "Action3",
                [2] = "Whirlwind"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
        elseif string.find(v.Name, "Shield") then
            local args = {
                [1] = "Action1",
                [2] = "BasicAttack"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
            local args = {
                [1] = "Action2",
                [2] = "BombShield"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
            local args = {
                [1] = "Action3",
                [2] = "HardSkin"
            }
                
            game:GetService("ReplicatedStorage").Knit.Services.ActionBarService.RE.SelectSkill:FireServer(unpack(args))
        end
    end
end)

autofarm:CreateLabel("~~Farm")

autofarm:CreateToggle("Enabled", function(bool)
    getgenv().enabled = bool


    
    beat = game:GetService("RunService").Heartbeat:Connect(function()
        pcall(function()
            if getgenv().enabled == true then
                if getgenv().target == "Nearest" then
                    repeat
                        if nearestMob():FindFirstChild("HumanoidRootPart") then
                            moveto(nearestMob().HumanoidRootPart.CFrame * CFrame.Angles(getgenv().mode, math.rad(0), 0) * CFrame.new(0,0,getgenv().distance))
                        end
                    wait()
                    until getgenv().enabled == false or not nearestMob():FindFirstChild("HumanoidRootPart")
                    if getgenv().enabled == false then
                        beat:Disconnect()
                    end
                elseif getgenv().target == "Random" then
                    for i,v in next, game:GetService("Workspace").RunTime[getgenv().area].Creatures:GetChildren() do
                        if v:FindFirstChild("HumanoidRootPart") then
                            repeat
                                if v:FindFirstChild("HumanoidRootPart") then
                                    moveto(v.HumanoidRootPart.CFrame * CFrame.Angles(getgenv().mode, math.rad(0), 0) * CFrame.new(0,0,getgenv().distance))
                                end
                            wait()
                            until getgenv().enabled == false or not nearestMob():FindFirstChild("HumanoidRootPart")
                            if getgenv().enabled == false then
                                beat:Disconnect()
                            end
                        end
                    end
                end
            end
        end)
    end)
    
    
    if getgenv().enabled == false then
        backtosafeTp()
    end
end)

autofarm:CreateToggle("Auto Loot [Semi Work]", function(bool)
    getgenv().loot = bool

    while wait() do
        if getgenv().loot == true then
            game:GetService('VirtualInputManager'):SendKeyEvent(true,"E",false,uwu)
        end
    end
end)

st:CreateLabel("~Auto Stat")

st:CreateDropdown("Stat List", statsTable, 1, function(selected)
    getgenv().stat = selected
end)

st:CreateToggle("Enabled", function(bool)
    getgenv().enabled1 = bool

    game:GetService("RunService").RenderStepped:Connect(function()
        if getgenv().enabled1 == true then
            local args = {
                [1] = getgenv().stat
            }
            
            game:GetService("ReplicatedStorage").Knit.Services.PrimaryStatsService.RF.AttributeStatPoint:InvokeServer(unpack(args))
        end
    end)
end)

st:CreateLabel("~~Teleports")

st:CreateLabel("~City~")

st:CreateButton("Mystery Shop", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(343, 4, -110)
end)

st:CreateButton("Shop", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(277, 4, -0)
end)

st:CreateButton("Daily Reward", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(338, 4, 5)
end)

st:CreateButton("Bank", function()
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(274, 4, 131)
end)

st:CreateLabel("~Area~")

tplist = st:CreateDropdown("Area List", areatpTable, 1, function(selected)
    getgenv().areatp = selected

    if selected then
        pesan("Teleport Notification!", "Make sure the area you choose is open otherwise you will be banned", 2.5)
    end
end)

st:CreateButton("Teleport", function()
    for i,v in pairs(game:GetService("Workspace").RegionsAssets[getgenv().areatp].Environment:GetChildren()) do
        if string.find(v.Name, "Zone") then
            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.CFrame * CFrame.new(0,3,0)
        end
    end
end)


-- Misc Section
sc:CreateLabel( "~~Server")

sc:CreateButton("Rejoin", function()
    game:GetService('TeleportService'):TeleportToPlaceInstance(game.PlaceId, game.JobId, game.Players.LocalPlayer)
end)

sc:CreateButton( "Server Hop", function()
    shop()
end)


sc:CreateLabel("~~Character")

sc:CreateSlider("Walk Speed", 19, 125, 16, 0, function(s)
    getgenv().ws = s
end)

sc:CreateSlider("Jump Power", 50, 125, 50, 0, function(s)
    getgenv().jp = s
end)

sc:CreateToggle("Enabled", function(bool)
    getgenv().wsjp =  bool

    local beat2

    beat2 = game:GetService("RunService").Heartbeat:Connect(function()
        if getgenv().wsjp == true then
            plyr.Character.Humanoid.WalkSpeed = getgenv().ws
            plyr.Character.Humanoid.JumpPower = getgenv().jp
        else
            plyr.Character.Humanoid.WalkSpeed = 19
            plyr.Character.Humanoid.JumpPower = 50
            beat2:Disconnect()  
        end
    end)
end)

sc:CreateLabel("~~Admin Gui")

sc:CreateButton("Infinite Yield", function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source"))()  
end)

sc:CreateLabel("~~UI Settings")

sc:CreateKeybind("Toggle Ui", Enum.KeyCode.RightAlt, false, false, function()
    local nx = nil
            
    if getgenv().toggleui then
        getgenv().toggleui = false
        TweenService:Create(nameGui().Main, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(0, 450, 0, 0)}):Play()
        TweenService:Create(nameGui().Main.Border, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {ImageTransparency = 1}):Play()    
    else
        getgenv().toggleui = true
        TweenService:Create(nameGui().Main, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Size = UDim2.new(0, 450, 0, 250)}):Play()
        TweenService:Create(nameGui().Main.Border, TweenInfo.new(0.5, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {ImageTransparency = 0}):Play()
    end
end)

sc:CreateButton("Destroy UI", function()
    for i,v in pairs(game.CoreGui:GetDescendants()) do
        if v.Name == "UITabs" and v.Parent.Name == "Main" then
            v.Parent.Parent:Destroy()
        end
    end
end)
